label.size = NA, fill = "white", size = 5, color = "#FAAB18") +
geom_label(aes(x = 2012, y = 250, label = "Average"), hjust = 0, vjust = 0.5,
label.size = NA, fill = "white", size = 5, color = "#1380A1") +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, factor(month)) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, factor(month)) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(factor(month), median_avg)) +
geom_line(aes(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
mutate(month = factor(month)) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
mutate(month = factor(month)) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
mutate(month = factor(month)) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
mutate(month = factor(month)) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year), group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
mutate(month = factor(month)) %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year), group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = year), group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
filter(year <= 2020) %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
filter(year < 2021) %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(group = 1) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
filter(year < 2021) %>%
group_by(month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year))) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
filter(year < 2021) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year))) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year))) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg))
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year))) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Players gaming on steam at the same time",
subtitle = "Median of players playing games, 2012-Current")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year))) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style()
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style()
games %>%
filter(year < 2021) %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style()
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style()
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers",
subtitle = "Median of players playing games, 2012-2020")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers",
subtitle = "Median of players playing games, 2012-current")
games %>%
group_by(year, month) %>%
summarise(median_avg = median(avg)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers")
games %>%
group_by(gamename, month) %>%
summarise(median_peak = median(peak)) %>%
ggplot(aes(month, median_avg)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers")
games %>%
group_by(gamename, month) %>%
summarise(median_peak = median(peak)) %>%
ggplot(aes(month, median_peak)) +
geom_line(aes(color = factor(year), group = year)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers")
games %>%
group_by(gamename, month) %>%
summarise(median_peak = median(peak)) %>%
ggplot(aes(month, median_peak)) +
geom_line(aes(color = gamename)) +
geom_hline(yintercept = 0, size = 1, colour="#333333") +
my_style() +
labs(title = "Highest Number of Steam gamers")
games %>%
group_by(gamename, month) %>%
summarise(median_peak = median(peak))
install.packages("scales")
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
# packages
library(tidyverse)
# theme
theme_set(theme_light())
unvotes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/unvotes.csv')
roll_calls <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/roll_calls.csv')
issues <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/issues.csv')
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
facet_wrap(~ issue)
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(scales::column) +
facet_wrap(~ issue)
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(labels = scales::comma) +
facet_wrap(~ issue)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
# packages
library(tidyverse)
# theme
theme_set(theme_light())
unvotes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/unvotes.csv')
roll_calls <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/roll_calls.csv')
issues <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/issues.csv')
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(labels = scales::comma) +
facet_wrap(~ issue)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
# packages
library(tidyverse)
# theme
theme_set(theme_light())
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(labels = scales::comma) +
facet_wrap(~ issue)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
# packages
library(tidyverse)
# theme
theme_set(theme_light())
unvotes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/unvotes.csv')
roll_calls <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/roll_calls.csv')
issues <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/issues.csv')
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(labels = scales::comma) +
facet_wrap(~ issue)
View(unvotes)
View(issues)
View(roll_calls)
View(roll_calls)
unvotes %>%
count(country, sort = TRUE)
View(unvotes)
unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
arrange(desc(pct_yes))
View(roll_calls)
View(unvotes)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
# packages
library(tidyverse)
# theme
theme_set(theme_light())
unvotes <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/unvotes.csv')
roll_calls <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/roll_calls.csv')
issues <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-23/issues.csv')
issues %>%
inner_join(unvotes, by = "rcid") %>%
ggplot(aes(vote)) +
geom_histogram(stat = "count") +
scale_y_continuous(labels = scales::comma) +
facet_wrap(~ issue)
unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
arrange(desc(pct_yes))
unvotes %>%
count(country, sort = TRUE)
unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
arrange(desc(pct_yes))
unvotes <- tt$unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2) %>%
left_join(tt$roll_calls %>%
select(rcid, date, amend), by = "rcid")
unvotes %>%
count(country, sort = TRUE)
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2) %>%
left_join(tt$roll_calls %>%
select(rcid, date, amend), by = "rcid")
unvotes %>%
count(country, sort = TRUE)
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2) %>%
left_join(roll_calls %>%
select(rcid, date, amend), by = "rcid")
unvotes %>%
count(country, sort = TRUE)
View(unvotes)
View(roll_calls)
summarize_votes <- function(tbl, min_votes = 10) {
tbl %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes,
.groups = "drop") %>%
filter(n_votes >= min_votes) %>%
arrange(desc(pct_yes))
}
by_country <- unvotes %>%
group_by(country, country_code) %>%
summarize_votes()
by_country %>%
slice(c(1:10, (n() - 10):n())) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = percent) +
labs(x = "% of yes votes in UN",
title = "What countries voted yes the least")
summarize_votes <- function(tbl, min_votes = 10) {
tbl %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes,
.groups = "drop") %>%
filter(n_votes >= min_votes) %>%
arrange(desc(pct_yes))
}
by_country <- unvotes %>%
group_by(country, country_code) %>%
summarize_votes()
by_country %>%
slice(c(1:10, (n() - 10):n())) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = scales::percent) +
labs(x = "% of yes votes in UN",
title = "What countries voted yes the least")
?match
match
?match
unvotes %>%
count(country, sort = TRUE)
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2)
unvotes %>%
count(country, sort = TRUE)
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2)
unvotes %>%
count(country, sort = TRUE)
unvotes %>%
count(country, sort = TRUE)
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")) - 2)
unvotes %>%
count(country, sort = TRUE)
unvotes %>%
count(vote, vote_number, sort = TRUE)
unvotes
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")))
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes")))
unvotes
unvotes <- unvotes %>%
mutate(vote_number = match(vote, c("no", "abstain", "yes"))-2)
unvotes %>%
count(vote, vote_number, sort = TRUE)
unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
filter(n_votes >= 100) %>%
arrange(desc(pct_yes))
unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
filter(n_votes >= 100) %>%
arrange(desc(pct_yes)) %>%
view()
by_country <- unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
filter(n_votes >= 100) %>%
arrange(desc(pct_yes))
by_country %>%
head(20) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes))
by_country %>%
head(20) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = percent) +
labs(x = "% of yes votes in UN")
by_country %>%
head(20) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = scales::percent) +
labs(x = "% of yes votes in UN")
by_country %>%
head(20) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = scales::percent) +
labs(x = "% of yes votes in UN")
by_country %>%
tail(20) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = scales::percent) +
labs(x = "% of yes votes in UN")
by_country <- unvotes %>%
group_by(country) %>%
summarize(n_votes = n(),
n_yes = sum(vote == "yes"),
pct_yes = n_yes / n_votes) %>%
filter(n_votes >= 100) %>%
arrange(desc(pct_yes))
by_country %>%
head(20) %>%
mutate(country = fct_reorder(country, pct_yes)) %>%
ggplot(aes(pct_yes, country)) +
geom_point(aes(size = n_votes)) +
scale_x_continuous(labels = scales::percent) +
labs(x = "% of yes votes in UN")
