View(notes_sentiment)
View(smote_departures)
smote_departures <- departures %>%
filter(!is.na(ceo_dismissal))
View(notes_sentiment)
departures %>%
inner_join(smote_departures %>% select(-departure_code), by = "exec_fullname")
departures %>%
inner_join(smote_departures %>%
select(-departure_code), by = "exec_fullname") %>%
view()
View(smote_departures)
departures %>%
inner_join(notes_sentiment %>%
select(-departure_code), by = "exec_fullname") %>%
view()
View(notes_sentiment)
departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
view()
smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
smote_departures <- smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, ceo_dismissal, K = 10)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
View(new_departure)
new_departure$syn_data
View(departures)
new_departure$data
View(new_departure)
?SMOTE
View(departures)
departures %>%
count(ceo_dismissal)
new_departure$data %>%
count(ceo_dismissal)
new_departure$syn_data %>%
count(ceo_dismissal)
new_departure$syn_data
library(tidyverse)
# Chunk 1
library(tidyverse)
# Chunk 2
departures <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-27/departures.csv')
# Chunk 3
departures <- departures %>%
group_by(coname) %>%
mutate(total_dismiss = n(),
ratio_dismissal = ceo_dismissal/total_dismiss) %>%
ungroup()
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot() +
geom_bar(aes("", n, fill = non_health_dismiss), stat="identity") +
coord_polar(theta = "y", start = 0)
# Chunk 4
departures %>%
count(ceo_dismissal) %>%
summarise(total = sum(n), ratio = n/total*100)
# Chunk 5
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot(aes(non_health_dismiss, n)) +
geom_area()
# Chunk 6
library(tidytext)
library(wordcloud)
departures %>%
select(notes, ratio_dismissal) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
count(word) %>%
arrange(desc(n)) %>%
filter(n > 100) %>%
with(wordcloud(word, n, max.words = 200))
# Chunk 7
library(textdata)
notes_sentiment <- departures %>%
select(notes, departure_code, exec_fullname) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
inner_join(get_sentiments("afinn")) %>%
group_by(departure_code, exec_fullname)%>%
summarise(senti_value = sum(value))
notes_sentiment %>%
group_by(departure_code) %>%
summarise(sentiment_code = sum(senti_value)) %>%
filter(!is.na(departure_code)) %>%
ggplot(aes(departure_code, sentiment_code)) +
geom_col()
# Chunk 8
library(smotefamily)
smote_departures <- smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
# Chunk 9
new_departure$data %>%
count(ceo_dismissal)
# Chunk 10
new_departure$syn_data %>%
count(ceo_dismissal)
# Chunk 11
new_departure$syn_data
# Chunk 1
library(tidyverse)
# Chunk 2
departures <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-27/departures.csv')
# Chunk 3
departures <- departures %>%
group_by(coname) %>%
mutate(total_dismiss = n(),
ratio_dismissal = ceo_dismissal/total_dismiss) %>%
ungroup()
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot() +
geom_bar(aes("", n, fill = non_health_dismiss), stat="identity") +
coord_polar(theta = "y", start = 0)
# Chunk 4
departures %>%
count(ceo_dismissal) %>%
summarise(total = sum(n), ratio = n/total*100)
# Chunk 5
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot(aes(non_health_dismiss, n)) +
geom_area()
# Chunk 6
library(tidytext)
library(wordcloud)
departures %>%
select(notes, ratio_dismissal) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
count(word) %>%
arrange(desc(n)) %>%
filter(n > 100) %>%
with(wordcloud(word, n, max.words = 200))
# Chunk 7
library(textdata)
notes_sentiment <- departures %>%
select(notes, departure_code, exec_fullname) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
inner_join(get_sentiments("afinn")) %>%
group_by(departure_code, exec_fullname)%>%
summarise(senti_value = sum(value))
notes_sentiment %>%
group_by(departure_code) %>%
summarise(sentiment_code = sum(senti_value)) %>%
filter(!is.na(departure_code)) %>%
ggplot(aes(departure_code, sentiment_code)) +
geom_col()
# Chunk 8
library(smotefamily)
smote_departures <- smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
# Chunk 9
new_departure$data %>%
count(ceo_dismissal)
# Chunk 10
new_departure$syn_data %>%
count(ceo_dismissal)
# Chunk 11
new_departure$syn_data
# Chunk 1
library(tidyverse)
# Chunk 2
departures <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-27/departures.csv')
# Chunk 3
departures <- departures %>%
group_by(coname) %>%
mutate(total_dismiss = n(),
ratio_dismissal = ceo_dismissal/total_dismiss) %>%
ungroup()
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot() +
geom_bar(aes("", n, fill = non_health_dismiss), stat="identity") +
coord_polar(theta = "y", start = 0)
# Chunk 4
departures %>%
count(ceo_dismissal) %>%
summarise(total = sum(n), ratio = n/total*100)
# Chunk 5
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot(aes(non_health_dismiss, n)) +
geom_area()
# Chunk 6
library(tidytext)
library(wordcloud)
departures %>%
select(notes, ratio_dismissal) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
count(word) %>%
arrange(desc(n)) %>%
filter(n > 100) %>%
with(wordcloud(word, n, max.words = 200))
# Chunk 7
library(textdata)
notes_sentiment <- departures %>%
select(notes, departure_code, exec_fullname) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
inner_join(get_sentiments("afinn")) %>%
group_by(departure_code, exec_fullname)%>%
summarise(senti_value = sum(value))
notes_sentiment %>%
group_by(departure_code) %>%
summarise(sentiment_code = sum(senti_value)) %>%
filter(!is.na(departure_code)) %>%
ggplot(aes(departure_code, sentiment_code)) +
geom_col()
# Chunk 8
library(smotefamily)
smote_departures <- smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
# Chunk 9
new_departure$data %>%
count(ceo_dismissal)
# Chunk 10
new_departure$syn_data %>%
count(ceo_dismissal)
# Chunk 11
new_departure$syn_data
new_departure$syn_data %>%
cor()
new_departure$data
departures <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-04-27/departures.csv')
departures <- departures %>%
group_by(coname) %>%
mutate(total_dismiss = n(),
ratio_dismissal = ceo_dismissal/total_dismiss) %>%
ungroup()
departures %>%
count(ceo_dismissal) %>%
summarise(total = sum(n), ratio = n/total*100)
departures %>%
filter(!is.na(ceo_dismissal)) %>%
select(coname, ceo_dismissal, ratio_dismissal) %>%
group_by(coname) %>%
summarise(non_health_dismiss = sum(ratio_dismissal*100)) %>%
group_by(non_health_dismiss) %>%
count() %>%
arrange(desc(non_health_dismiss)) %>%
ggplot(aes(non_health_dismiss, n)) +
geom_area()
departures %>%
select(notes, ratio_dismissal) %>%
unnest_tokens(word, notes) %>%
anti_join(stop_words, by = "word") %>%
count(word) %>%
arrange(desc(n)) %>%
filter(n > 100) %>%
with(wordcloud(word, n, max.words = 200))
notes_sentiment %>%
group_by(departure_code) %>%
summarise(sentiment_code = sum(senti_value)) %>%
filter(!is.na(departure_code)) %>%
ggplot(aes(departure_code, sentiment_code)) +
geom_col()
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
library(smotefamily)
smote_departures <- smote_departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
smote_departures <- departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
View(smote_departures)
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
View(notes_sentiment)
smote_departures <- departures %>%
inner_join(notes_sentiment, by = c("exec_fullname","departure_code")) %>%
select(fyear, departure_code, ceo_dismissal, tenure_no_ceodb, max_tenure_ceodb, total_dismiss, ratio_dismissal, senti_value) %>%
filter(!is.na(ceo_dismissal))
new_departure <- SMOTE(smote_departures, smote_departures$ceo_dismissal, K = 10)
View(smote_departures)
View(new_departure)
new_departure$data %>%
count(ceo_dismissal)
new_departure$syn_data %>%
count(ceo_dismissal)
new_departure$data
new_departure$data %>%
co.intervals()
new_dataset <- new_departure$data
View(new_dataset)
new_dataset %>%
count(n)
new_dataset %>%
count(ceo_dismissal)
new_dataset %>%
mutate(count(ceo_dismissal))
new_dataset %>%
mutate(total_count = n(ceo_dismissal))
new_dataset %>%
count(total_count = n(ceo_dismissal))
new_dataset %>%
count(year, ceo_dismissal)
new_dataset %>%
count(year, ceo_dismissal)
new_dataset %>%
count(fyear, ceo_dismissal)
library(lubridate)
new_dataset %>%
count(year(fyear), ceo_dismissal)
View(new_dataset)
new_dataset %>%
mutate(fyear = year(fyear))
new_dataset %>%
mutate(fyear = as.Date(fyear))
new_dataset %>%
mutate(fyear = as.Date(as.character(fyear), format = "%Y"))
new_dataset %>%
mutate(fyear = as.Date(as.character(fyear), format = "%Y"),
fyear = year(fyear))
new_dataset <- new_dataset %>%
mutate(fyear = as.Date(as.character(fyear), format = "%Y"),
fyear = year(fyear))
View(smote_departures)
new_dataset %>%
count(fyear, ceo_dismissal)
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) %>%
geom_line(aes(fill = ceo_dismissal))
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(fill = ceo_dismissal))
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal))
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal))
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
departures %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
departures %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, factor(ceo_dismissal)) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
departures %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, factor(ceo_dismissal)) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
new_dataset %>%
count(fyear, factor(ceo_dismissal)) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
new_dataset <- new_dataset %>%
mutate(fyear = as.Date(as.character(fyear), format = "%Y"),
fyear = year(fyear), ceo_dismissal = factor(ceo_dismissal))
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
departures %>%
mutate(ceo_dismissal = factor(ceo_dismissal)) %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point()
cor(new_dataset)
departures %>%
mutate(ceo_dismissal = factor(ceo_dismissal)) %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
departures %>%
filter(fyear < 2020) %>%
mutate(ceo_dismissal = factor(ceo_dismissal)) %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
departures %>%
filter(fyear < 2019) %>%
mutate(ceo_dismissal = factor(ceo_dismissal)) %>%
filter(!is.na(ceo_dismissal)) %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
new_dataset %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
new_dataset %>%
filter(fyear < 2019) %>%
count(fyear, ceo_dismissal) %>%
ggplot(aes(fyear, n)) +
geom_line(aes(color = ceo_dismissal)) +
geom_point() +
geom_smooth()
new_dataset %>%
glm.fit = glm(ceo_dimissmal ~ .)
new_dataset %>%
glm.fit = glm(ceo_dimissmal ~ fyear+departure_code + tenure_no_ceodb:senti_value)
new_dataset %>%
glm(ceo_dimissmal ~ fyear+departure_code + tenure_no_ceodb:senti_value)
new_dataset %>%
glm(ceo_dimissmal ~ fyear+departure_code + tenure_no_ceodb:senti_value, family = binomial)
new_dataset %>%
glm(ceo_dimissmal ~ fyear+departure_code + tenure_no_ceodb:senti_value,
family = binomial)
glm(ceo_dimissmal ~ fyear+departure_code + tenure_no_ceodb:senti_value, data = new_dataset, family = binomial)
glm(ceo_dismissal ~ fyear+departure_code + tenure_no_ceodb:senti_value, data = new_dataset, family = binomial)
glm(ceo_dismissal ~ ., data = new_dataset, family = binomial)
glm.fit = glm(ceo_dismissal ~ ., data = new_dataset, family = binomial)
summary(glm.fit)
glm.fit = glm(ceo_dismissal ~ departure_code, data = new_dataset, family = binomial)
summary(glm.fit)
glm.fit = glm(ceo_dismissal ~ departure_code+senti_value, data = new_dataset, family = binomial)
summary(glm.fit)
glm.fit = glm(ceo_dismissal ~ departure_code+ fyear, data = new_dataset, family = binomial)
summary(glm.fit)
glm.fit = glm(ceo_dismissal ~ departure_code+ratio_dismissal, data = new_dataset, family = binomial)
summary(glm.fit)
glm.fit = glm(ceo_dismissal ~ departure_code+senti_value, data = new_dataset, family = binomial)
glm.fit = glm(ceo_dismissal ~ departure_code+senti_value, data = new_dataset, family = binomial)
summary(glm.fit)
