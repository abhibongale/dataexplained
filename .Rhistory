y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarise(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= 0.1) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= 0.1) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= 0.1) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= 0.1) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= .01) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= .01) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent()) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
View(model)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= .01) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= .01) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category, year = 2 * (year %/% 2)) %>%
summarise(percent = mean(value),
n = n()) %>%
ggplot(aes(year, percent, color = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none") +
labs(x = "2-year period",
y = "% of ads with this quality")
glm(animals ~ year,
data = youtube,
family = "binomial") %>%
summary()
model <- youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category) %>%
summarize(model = list(glm(value ~ year, family = "binomial"))) %>%
mutate(td = map(model, broom::tidy)) %>%
unnest(td) %>%
filter(term != "(Intercept)") %>%
arrange(desc(estimate))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(category,
year = 2 * (year %/% 2)) %>%
summarize(percnt = mean(value),
n = n()) %>%
inner_join(model, by = "category") %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
filter(p.value <= .05) %>%
ggplot(aes(year, percnt, colour = category)) +
geom_line() +
scale_y_continuous(labels = scales::percent) +
facet_wrap(~ category) +
theme(legend.position = "none")
labs(x = "Time(rounded to 2-years)",
y = "% of ads with this quality")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value))
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
ggplot(aes(percnt, brand)) +
facet_wrap(~ category)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
facet_wrap(~ category)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
mutate(brand = fct_reorder(brand, percnt)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
facet_wrap(~ category)
install.packages("tidytext")
library(tidytext)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
facet_wrap(~ category)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
scale_y_reordered() +
geom_col() +
facet_wrap(~ category)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_y_reordered() +
facet_wrap(~ category)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_x_continuous(labels = scales::percent) +
scale_y_reordered() +
facet_wrap(~ category)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_x_continuous(labels = scales::percent) +
scale_y_reordered() +
facet_wrap(~ category)
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ category)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ category, scales = "free_y")
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(brand = reorder_within(brand, percnt, category)) %>%
ggplot(aes(percnt, brand)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ category, scales = "free_y")
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(category = reorder_within(category, percnt, brand)) %>%
ggplot(aes(percnt, category)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ category, scales = "free_y")
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(category = reorder_within(category, percnt, brand)) %>%
ggplot(aes(percnt, category)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ brand, scales = "free_y")
library(tidytext)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ungroup() %>%
mutate(category = reorder_within(category, percnt, brand)) %>%
ggplot(aes(percnt, category)) +
geom_col() +
scale_y_reordered() +
scale_x_continuous(labels = scales::percent) +
facet_wrap(~ brand, scales = "free_y") +
labs(title = "What's is each brand preferred ads genre/category?")
?reorder_within
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ggplot(aes(category, brand, fill = percnt)) +
geom_tile()
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ggplot(aes(category, brand, fill = percnt)) +
geom_tile() +
scale_fill_gradient2(low = "#1380A1", high = "#FAAB18", midpoint = 0.5)
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
ggplot(aes(category, brand, fill = percnt)) +
geom_tile() +
scale_fill_gradient2(low = "#1380A1", high = "#990000", midpoint = 0.5)
install.packages("reshape2")
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
reshape2::acast(brand ~ category, value.var = "percnt")
?reshape2
?reshape2::acast
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
reshape2::acast(brand ~ category, value.var = "percnt") +
heatmap()
youtube %>%
pivot_longer(funny:use_sex, names_to = "category") %>%
group_by(brand, category) %>%
mutate(category = str_to_title(str_replace_all(category, "_", " "))) %>%
summarise(percnt = mean(value)) %>%
reshape2::acast(brand ~ category, value.var = "percnt") %>%
heatmap()
