filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
gender %>%
filter(County != "Total") %>%
pivot_longer(Male:Intersex, names_to = "gender", values_to = "count") %>%
mutate(gender_percent = count/Total*100,
County = fct_reorder(County, Total)) %>%
ggplot(aes(gender_percent, County)) +
geom_col(aes(fill = gender)) +
geom_vline(xintercept = 50, size = 1, colour ="#990000" ,
linetype="longdash") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
scale_fill_manual(values = c("#FAAB18", "#588300", "#1380A1")) +
labs(x = "",
y = "County",
title = "Kenya Population in EveryCounty",
subtitle = "Population Percentage As per Gender , 2019",
fill = "") +
theme(legend.position = "top")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = TRUE)
library(tidyverse) # metadata of packages
theme_set(theme_light())
# Chunk 2
gender <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/gender.csv')
crops <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/crops.csv')
households <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-19/households.csv')
# Chunk 3
gender %>%
filter(County != "Total") %>%
pivot_longer(Male:Intersex, names_to = "gender", values_to = "count") %>%
mutate(gender_percent = count/Total*100,
County = fct_reorder(County, Total)) %>%
ggplot(aes(gender_percent, County)) +
geom_col(aes(fill = gender)) +
geom_vline(xintercept = 50, size = 1, colour ="#990000" ,
linetype="longdash") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
scale_fill_manual(values = c("#FAAB18", "#588300", "#1380A1")) +
labs(x = "",
y = "County",
title = "Kenya Population in EveryCounty",
subtitle = "Population Percentage As per Gender , 2019",
fill = "") +
theme(legend.position = "top")
# Chunk 4
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
# Chunk 5
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
# Chunk 6
library(wesanderson)
pal <- wes_palette("Zissou1", 100, type = "continuous")
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
# Chunk 7
households_crops <- crops %>%
filter(SubCounty != "KENYA") %>%
rename(County = SubCounty,
Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(County = str_to_title(County),
County = fct_reorder(County, Count, sum)) %>%
complete(Crop, County, fill = list(Count = 0)) %>%
inner_join(households, by = "County")
# Chunk 8
households_crops %>%
mutate(pop_farm = round(Count/Population*100,0),
house_farm = Count/NumberOfHouseholds) %>%
mutate(County = fct_reorder(County, pop_farm, sum)) %>%
ggplot(aes(pop_farm, County)) +
geom_col(fill = "#1380A1") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "",
title = "Population in Agriculture",
subtitle = "% of Population w.r.t County")
# Chunk 9
library(rKenyaCensus)
library(sf)
library(ggthemes)
kenya_sf <- KenyaCounties_SHP %>%
st_as_sf() %>%
st_simplify(dTolerance = 200) %>%
mutate(County = str_to_title(County)) %>%
left_join(households_crops %>% filter(Crop == "Tea"), by = "County")
kenya_sf %>%
ggplot() +
geom_sf(aes(fill = Count)) +
scale_fill_gradient(low = "#1380A1", high = "#FAAB18") +
labs(title = "Tea Production") +
theme_map()
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "") +
guides(fill = guide_legend(reverse = TRUE))
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
crops %>%
filter(SubCounty != "KENYA") %>%
pivot_longer(Farming:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
ggplot(aes(Count, SubCounty)) +
geom_col(aes(fill = Crop)) +
scale_x_continuous(labels = scales::comma) +
labs(x = "",
title = "Kenya Agriculture",
subtitle = "Population in Cultivation, 2019",
fill = "")
households_crops <- crops %>%
filter(SubCounty != "KENYA") %>%
rename(County = SubCounty,
Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(County = str_to_title(County),
County = fct_reorder(County, Count, sum)) %>%
complete(Crop, County, fill = list(Count = 0)) %>%
inner_join(households, by = "County")
households_crops <- crops %>%
filter(SubCounty != "KENYA") %>%
rename(County = SubCounty,
Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(County = str_to_title(County),
County = fct_reorder(County, Count, sum)) %>%
complete(Crop, County, fill = list(Count = 0)) %>%
inner_join(households, by = "County")
households_crops %>%
mutate(pop_farm = round(Count/Population*100,0),
house_farm = Count/NumberOfHouseholds) %>%
mutate(County = fct_reorder(County, pop_farm, sum)) %>%
ggplot(aes(pop_farm, County)) +
geom_col(fill = "#1380A1") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "",
title = "Population in Agriculture",
subtitle = "% of Population w.r.t County")
households_crops %>%
mutate(pop_farm = round(Count/Population*100,0),
house_farm = Count/NumberOfHouseholds) %>%
mutate(County = fct_reorder(County, pop_farm, sum)) %>%
ggplot(aes(pop_farm, County)) +
geom_col(fill = "#1380A1") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "",
title = "Population in Agriculture",
subtitle = "% of Population w.r.t County")
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
households_crops %>%
mutate(pop_farm = round(Count/Population*100,0),
house_farm = Count/NumberOfHouseholds) %>%
mutate(County = fct_reorder(County, pop_farm, sum)) %>%
ggplot(aes(pop_farm, County)) +
geom_col(fill = "#1380A1") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "",
title = "Population in Agriculture",
subtitle = "% of Population w.r.t County")
households_crops <- crops %>%
filter(SubCounty != "KENYA") %>%
rename(County = SubCounty,
Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(County = str_to_title(County),
County = fct_reorder(County, Count, sum)) %>%
complete(Crop, County, fill = list(Count = 0)) %>%
inner_join(households, by = "County")
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture")
households_crops <- crops %>%
filter(SubCounty != "KENYA") %>%
rename(County = SubCounty,
Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(County = str_to_title(County),
County = fct_reorder(County, Count, sum)) %>%
complete(Crop, County, fill = list(Count = 0)) %>%
inner_join(households, by = "County")
households_crops %>%
mutate(pop_farm = round(Count/Population*100,0),
house_farm = Count/NumberOfHouseholds) %>%
mutate(County = fct_reorder(County, pop_farm, sum)) %>%
ggplot(aes(pop_farm, County)) +
geom_col(fill = "#1380A1") +
geom_vline(xintercept = 0, size = 1, colour = "#333333") +
scale_x_continuous(labels = scales::percent_format(scale = 1)) +
labs(x = "",
title = "Population in Agriculture",
subtitle = "% of Population w.r.t County",
x = "")
crops %>%
filter(SubCounty != "KENYA") %>%
rename(Crops = Farming) %>%
pivot_longer(Crops:`Khat (Miraa)`,
names_to = "Crop", values_to = "Count") %>%
filter(!is.na(Count)) %>%
mutate(SubCounty = str_to_title(SubCounty),
SubCounty = fct_reorder(SubCounty, Count, sum)) %>%
complete(Crop, SubCounty, fill = list(Count = 0)) %>%
ggplot(aes(Crop, SubCounty)) +
geom_tile(aes(fill = Count)) +
scale_fill_gradientn(colours = pal, labels = scales::comma) +
scale_x_discrete(expand = c(0, 0)) +
scale_y_discrete(expand = c(0, 0)) +
labs(fill = "Population",
title = "Kenya Agriculture",
subtitle = "Population in Agriculture",
x = "")
